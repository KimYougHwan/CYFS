# 发布带前端的 Dec App 到 OOD

通过上一个章节的学习，我们已经为留言板实现了一个前端展示页面。
现在，我们连同前端和 dec_service 一起发布到 OOD 上。

## 发布前的代码调整

1. 为了能与好友在真实环境下进行留言板互动，请打开 src/common/constant.ts 文件，修改 `PEOPLE_IDS` 为`你自己的 peopleId` 以及`好友的 peopleId`。
2. 为了带上前端页面，请打开根目录下的 cyfs.config.json 文件，修改`web`为：

```json
"web": {
    "folder": "src/www/dist",
    "entry": "index.html"
}
```

## 编译和打包项目

由于我们模板项目的前端部分是使用 React 框架进行开发，因此，需要使用 webpack 进行打包。
在项目根目录下，运行如下指令：

```shell
yarn build
```

指令执行完，可以在项目根目录下看到新增了 dist 和 deploy 文件夹：

- dist: 前端打包产物，由 webpack 生成。
- deploy: 发布到 OOD 的文件夹，包含了项目中所有 ts 文件 编译后的 js 文件，由 tsconfig.json 配置

## 发布 Dec App 到 OOD

我们先打开 CYFS 浏览器再运行如下指令:

- mac

```shell
yarn mac-deploy-pre
yarn deploy
```

- windows

```shell
yarn deploy
```

最终，终端会显示上传的信息，上传完成后，终端显示如下信息：

```
Upload DecApp Finished.
CYFS App Install Link: cyfs://5r4MYfFbqqyqoA4RipKdGEKQ6ZSX3JzNRaEpMPKiKWAQ/9tGpLNnbNtojWgQ3GmU2Y7byFm7uHDr1AH2FJBoGt5YF
```

恭喜你，这代表我们的 Dec App 已经成功发布到了 OOD。

请把`CYFS App Install Link`对应的链接复制下来，下一节我们将会使用这个链接进行 Dec App 的安装。

# 去 CYFS 浏览器中安装 Dec App 并查看

1. 复制 `CYFS App Install Link` 后面的这串 CYFS 链接，去 CYFS 浏览器中打开 Dec App Store 页面(cyfs://static/DecAppStore/app_store_list.html)，点击*通过 URL 安装*按钮，把刚才 Dec App 的安装链接粘贴进去，安装即可。
2. 安装完成后，可以去应用已安装列表页面(cyfs://static/DecAppStore/app_installed_list.html)看到刚刚安装好的 Dec App。
3. Dec App 的前端入口，可以在 CYFS 浏览器首页(cyfs://static/browser.html)或者已安装列表找到，点击即可查看前端效果。

# 发给好友测试一下

在前文`发布前的代码调整`中，我们对 `PEOPLE_IDS` 进行了修改，其中的一个 peopleId 就是你的好友 peopleId,可以把 `CYFS App Install Link` 对应的链接发给那个好友。
根据`去 CYFS 浏览器中安装 Dec App 并查看`的步骤指引，让你的好友也成功安装上我们的留言板 Dec App！

## 发布一条留言试试

你跟你的好友可以试试发布一条留言，你们各自会在自己的留言板上看到自己最新发布的留言信息，但是看不到对方的留言信息。
也就是说，折腾了这么久，现在只能看到自己的留言板信息，这就是个 `单机版` 的留言板。
你可能会问，要怎么样把 `单机版` 变成 `联机版`呢？
其实只需要 2 步即可：

1. 在留言服务的创建、修改和删除留言功能中增加通知好友的功能
2. 开放对以上功能对应的请求路径的权限(access)

## 在留言服务中增加通知好友的功能

## 只能自己看自己的：首次面对权限问题

## CYFS ACL 基本设计，增加读权限

## 如何添加合理的写权限：好友可写
