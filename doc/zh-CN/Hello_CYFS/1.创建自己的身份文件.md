# 创建自己的身份文件
```
cyfs://o/$owner_id/$obj_id
```
我们继续CYFS Object URL创建之旅。    
一个有效的身份可用$owner_id表达,$owner_id在逻辑上可以认为是公钥的Hash。在实现上，$owner_id和$obje_id一样，都是CYFS NamedObject Id。能称作owner_id的，是Desc中包含"publick key"的NamedObject,这类NamedObject我们称作"有权对象"。在这里详细的介绍NamedObject还有一点早，但我们只要知道，不管是OOD，还是CYFS 浏览器要能在CYFS Network里被识别，都需要一个有效的身份（DevcieObject）。这个身份的结构如下图:
![people-object](../image/people-object.png)

因此在使用CYFS系统前，必须给OOD，以及CYFS浏览器绑定DeviceObject,DevceObject的Owner则指向一个PeopleObject,PeopleObject类似很多系统里的开发者身份证书。CYFS是一个去中心系统，因此任何人无须审批就可以基于密码学工具在本地直接创建PeopleObject。


# 使用CYFS TOOL创建身份
这种绑定方式只需要一台PC即可完成。

使用此种方式激活后，会在控制台打印助记词。请将助记词记录下来，并妥善保管。后续可以使用该助记词，在超送中恢复身份，并继续用超送管理身份和已激活的设备。

安装cyfs-tool：    
使用命令行`npm i -g cyfs-tool`，安装beta版本的cyfs-tool工具
> 如果想要安装nightly版本线的cyfs-tool，需要执行命令`npm i -g cyfs-tool-nightly`
注意cyfs-tool的版本线必须和要操作的ood/runtime的版本线相匹配。使用不匹配的版本会导致未预料的各种错误

## 直接使用CYFS TOOL命令，绑定本机已安装的OOD或runtime
1. 绑定OOD
   > 安装好OOD之后，确定ood-daemon进程在运行。执行`cyfs desc -a`命令，该命令会自动检查本机是否有未激活的OOD和runtime。如有，自动创建身份并进行激活

   > 该命令会在控制台输出一组12个单词的助记词，请将助记词记录下来，并妥善保管
2. 绑定runtime
   > 先安装CYFS浏览器，并启动。确保浏览器上显示扫码激活页面

   > 执行`cyfs desc -a -m "助记词组" --only-runtime`命令，这里-m参数必须输入上一步，在绑定OOD时输出的助记词组，词组必须用双引号括起来。执行完毕后，浏览器应该会自动转到主页

## 生成身份，用于后续手工绑定OOD和Runtime
1. 生成成套的身份
    > 使用命令`cyfs desc -s <save_path>`，生成配套的身份文件，保存在save_path目录下。如果不指定save_path，默认为~/.cyfs_profile

    > 生成的`<save_path>/people.desc`和`<save_path>/people.sec`文件是自己身份的密钥对，请妥善保存，切勿删除

    > 该命令会在控制台输出一组12个单词的助记词，请将助记词记录下来，并妥善保管
2. 绑定OOD
    > 身份生成后，复制`<save_path>/ood.desc`和`<save_path>/ood.sec`两个文件到OOD机器的`${cyfs_root}/etc/desc`下，并重命名为`device.desc`和`device.sec`
3. 绑定CYFS浏览器
    > 身份生成后，复制`<save_path>/runtime.desc`和`<save_path>/runtime.sec`两个文件到CYFS浏览器机器的`${cyfs_runtime_root}/etc/desc`下，并重命名为`device.desc`和`device.sec`

`${cyfs_root}`具体路径：
- Windows: `c:\cyfs`
- MacOS: `~/Library/cyfs`
- 其他系统: `/cyfs`

`${cyfs_runtime_root}`具体路径：
- Windows: `%appdata%/cyfs`
- Mac OS: `~/Library/Application Support/cyfs`

### 身份与MetaChain
无论是直接绑定，还是生成身份后续手工绑定，生成的PeopleObject和OOD DeviceObject都会上链。

目前，PeopleObject首次上链时，链会给一些赠币。PeopleObject和OOD DeviceObject上链时所花费的手续费都是从赠币中扣除的

除了激活功能外，CYFS TOOL还提供了其他有助使用和Dec App开发的其他功能。详见
[CYFS TOOL命令说明](https://github.com/buckyos/cyfs-ts-sdk/blob/master/doc/cn/sdk%E5%91%BD%E4%BB%A4.md)

# 使用CYFS 浏览器创建身份
为了方便普通用户使用，我们计划通过CYFS Browser支持PeopleObject的构建和VirtualOOD的绑定。当相关功能完成开发后我们会补充在这里。

# 使用CyberChat绑定身份
这是我们推荐的，最为安全的方法，关键的PeopleObject秘钥保存在手机上。该方法适用于所有种类的OOD，操作简单方便

1. 安装CyberChat（[下载页](../Download.md))，CyberChat的中文名是超送。按照提示创建身份
2. 绑定OOD：先安装OOD，从官网二进制，或者自己编译的OOD均可。安装后：
   > - 如果OOD和超送在同一个局域网，可用超送的扫描绑定功能直接绑定
   > - 如果OOD和超送不在同一个局域网，先确定你的防火墙规则允许1325端口被访问，在OOD上执行`./ood-installer --bind`后，使用超送扫描终端展示的二维码进行绑定
3. 绑定runtime：安装CYFS浏览器，初始使用按提示扫描网页中的二维码进行绑定

# 上述文件组成的密码学身份网络说明
1. 首先基于助记词我们得到了People秘钥对（默认使用RSA 1024算法），并构造了包含People PublickKey的PeopleObject。
2. 随后我们通过People的私钥，再产生OOD秘钥对，并构造包含OOD PublicKey的DeviceObject，并把Owner设置成了第一步构造的PeopleObject. 然后用People私钥签名OOD DeviceObject的Desc和Body部分
3. 最后我们产生Runtime秘钥对，并按类似过程构建Runtime DeviceObject。
4. 我们把上述Object和私钥分别复制到对应设备的指定目录。
如下图所示，
![private-keys](../image/privatekeys.png)

# 小结
本章我们学习了CYFS 密码学身份（DID）的构造，并了解了其基本原理。我们还为这些身份绑定了关键的OOD，同一个People拥有的所有Device，组成了CYFS网络中的Zone，Zone内的中心节点是OOD。到这里我们已经完成了准备工作，下一章我们将完成文件的发布。 